<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>浏览器的组成 | 青山小站</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/record/avatar.jpg">
    <meta name="description" content="Record about my studies">
    
    <link rel="preload" href="/record/assets/css/0.styles.4f63f36b.css" as="style"><link rel="preload" href="/record/assets/js/app.b06d3f04.js" as="script"><link rel="preload" href="/record/assets/js/2.f3c80cc9.js" as="script"><link rel="preload" href="/record/assets/js/4.df3bbc3b.js" as="script"><link rel="prefetch" href="/record/assets/js/10.3897ca15.js"><link rel="prefetch" href="/record/assets/js/11.1f568d2b.js"><link rel="prefetch" href="/record/assets/js/12.ad7f32c8.js"><link rel="prefetch" href="/record/assets/js/13.09c35d99.js"><link rel="prefetch" href="/record/assets/js/14.d3cc558f.js"><link rel="prefetch" href="/record/assets/js/15.eda2cdb6.js"><link rel="prefetch" href="/record/assets/js/16.5cee2a4b.js"><link rel="prefetch" href="/record/assets/js/17.fd833661.js"><link rel="prefetch" href="/record/assets/js/18.8f24cbb2.js"><link rel="prefetch" href="/record/assets/js/19.4953a67c.js"><link rel="prefetch" href="/record/assets/js/20.5c0d8022.js"><link rel="prefetch" href="/record/assets/js/21.13951061.js"><link rel="prefetch" href="/record/assets/js/22.22c5bfd8.js"><link rel="prefetch" href="/record/assets/js/3.ab68dbfc.js"><link rel="prefetch" href="/record/assets/js/5.58ec5344.js"><link rel="prefetch" href="/record/assets/js/6.e82f5c11.js"><link rel="prefetch" href="/record/assets/js/7.bf267eaf.js"><link rel="prefetch" href="/record/assets/js/8.816423d1.js"><link rel="prefetch" href="/record/assets/js/9.44097ae7.js">
    <link rel="stylesheet" href="/record/assets/css/0.styles.4f63f36b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/record/" class="home-link router-link-active"><img src="/record/avatar.jpg" alt="青山小站" class="logo"> <span class="site-name can-hide">青山小站</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/record/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端开发" class="dropdown-title"><span class="title">前端开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端开发" class="mobile-dropdown-title"><span class="title">前端开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/pages/frontend/javascript.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/record/pages/frontend/css.html" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/record/pages/frontend/vue.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/record/pages/frontend/browser.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  浏览器
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/pages/cs/network.html" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/record/pages/cs/dataStructure.html" class="nav-link">
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/record/pages/cs/cpp.html" class="nav-link">
  CPP
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目开发" class="dropdown-title"><span class="title">项目开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="项目开发" class="mobile-dropdown-title"><span class="title">项目开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/pages/develop/git.html" class="nav-link">
  git
</a></li><li class="dropdown-item"><!----> <a href="/record/pages/develop/webpack.html" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/record/pages/develop/design.html" class="nav-link">
  设计模式
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="岁月冗长" class="dropdown-title"><span class="title">岁月冗长</span> <span class="arrow down"></span></button> <button type="button" aria-label="岁月冗长" class="mobile-dropdown-title"><span class="title">岁月冗长</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/pages/life/grammar.html" class="nav-link">
  English Studies
</a></li><li class="dropdown-item"><!----> <a href="/record/pages/life/record.html" class="nav-link">
  Life Record
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/record/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端开发" class="dropdown-title"><span class="title">前端开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端开发" class="mobile-dropdown-title"><span class="title">前端开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/pages/frontend/javascript.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/record/pages/frontend/css.html" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/record/pages/frontend/vue.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/record/pages/frontend/browser.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  浏览器
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/pages/cs/network.html" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/record/pages/cs/dataStructure.html" class="nav-link">
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/record/pages/cs/cpp.html" class="nav-link">
  CPP
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目开发" class="dropdown-title"><span class="title">项目开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="项目开发" class="mobile-dropdown-title"><span class="title">项目开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/pages/develop/git.html" class="nav-link">
  git
</a></li><li class="dropdown-item"><!----> <a href="/record/pages/develop/webpack.html" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/record/pages/develop/design.html" class="nav-link">
  设计模式
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="岁月冗长" class="dropdown-title"><span class="title">岁月冗长</span> <span class="arrow down"></span></button> <button type="button" aria-label="岁月冗长" class="mobile-dropdown-title"><span class="title">岁月冗长</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/record/pages/life/grammar.html" class="nav-link">
  English Studies
</a></li><li class="dropdown-item"><!----> <a href="/record/pages/life/record.html" class="nav-link">
  Life Record
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>前端开发</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/record/pages/frontend/javascript.html" class="sidebar-link">JavaScript</a></li><li><a href="/record/pages/frontend/css.html" class="sidebar-link">Css</a></li><li><a href="/record/pages/frontend/vue.html" class="sidebar-link">Vue</a></li><li><a href="/record/pages/frontend/browser.html" aria-current="page" class="active sidebar-link">浏览器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/record/pages/frontend/browser.html#浏览器的组成" class="sidebar-link">浏览器的组成</a></li><li class="sidebar-sub-header"><a href="/record/pages/frontend/browser.html#浏览器的进程" class="sidebar-link">浏览器的进程</a></li><li class="sidebar-sub-header"><a href="/record/pages/frontend/browser.html#浏览器的网络请求" class="sidebar-link">浏览器的网络请求</a></li><li class="sidebar-sub-header"><a href="/record/pages/frontend/browser.html#浏览器的渲染过程" class="sidebar-link">浏览器的渲染过程</a></li><li class="sidebar-sub-header"><a href="/record/pages/frontend/browser.html#浏览器的同源策略" class="sidebar-link">浏览器的同源策略</a></li><li class="sidebar-sub-header"><a href="/record/pages/frontend/browser.html#浏览器的安全" class="sidebar-link">浏览器的安全</a></li><li class="sidebar-sub-header"><a href="/record/pages/frontend/browser.html#浏览器的存储" class="sidebar-link">浏览器的存储</a></li><li class="sidebar-sub-header"><a href="/record/pages/frontend/browser.html#浏览器的垃圾回收机制" class="sidebar-link">浏览器的垃圾回收机制</a></li><li class="sidebar-sub-header"><a href="/record/pages/frontend/browser.html#番外-抽象语法树的编译" class="sidebar-link">番外：抽象语法树的编译</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="浏览器的组成"><a href="#浏览器的组成" class="header-anchor">#</a> 浏览器的组成</h2> <p>了解浏览器的运行，首先要先了解浏览器的组成。浏览器由<code>shell</code>(命令解析代理，简单来说就是<code>代理用户对内核的操作</code>)和浏览器<code>内核</code>组成。</p> <p>shell 组成：</p> <ul><li>用户界面：除浏览器请求的页面以外，都属于用户界面。</li> <li>网络：用于网络请求，包含多种文件传输协议，如HTTP、FTP等。</li> <li>UI后端：用于绘制''对话框''等基本组件。</li> <li>JS解释器：解释并执行网页中的javascript代码</li> <li>XML解析器：将XML文档解析成文档对象模型(DOM)</li> <li>数据存储：将浏览器数据存储在硬盘上</li></ul> <p>内核组成：</p> <ul><li><p>浏览器引擎：为渲染引擎提供高级接口</p></li> <li><p>渲染引擎：负责显示请求的内容。负责解析请求到的HTML、CSS 并将其显示</p></li></ul> <h2 id="浏览器的进程"><a href="#浏览器的进程" class="header-anchor">#</a> 浏览器的进程</h2> <p>除了浏览器的组成，在谈到一段程序在计算机中的运行时，那必须提到<code>进程</code>和<code>线程</code>的概念</p> <ul><li><strong>进程(资源分配的最小单位)</strong>：<strong>一个<code>执行中程序</code>的实例</strong></li></ul> <p>早期<code>单道批操作系统</code>的计算机，仅执行一个程序，由其分配所有的系统资源，利用率非常低。后改进为<code>多道批操作系统</code>，可以在内存中同时加载多道程序并发执行，在某个程序需要等待资源时，CPU会去执行其他程序，但因为各个程序共享资源，导致经常出现资源冲突问题。因此提出了<code>进程</code>的概念，只有进程可以申请系统资源，进程间不会共享资源。系统通过PCB(<em>process control block</em>)对进程进行管理和调度。</p> <ul><li><strong>线程(CPU调度的最小单位)</strong>：线程是进程中的一个实体</li></ul> <p>因为进程的创建、销毁与切换存在着较大的时空开销，因此提出了<code>线程</code>来减少开销。同一进程间的线程共享进程的资源。因为线程是进程的的组成部分，所以线程的管理(<em>通过线程控制块TCB</em>)可以有两种选择，一种是让进程自己管理线程(<strong>用户态线程</strong>)，另一种是通过操作系统管理线程(<strong>内核态线程</strong>)，但用于两种选择都有缺陷，现代操作系统选择将二者结合起来，<code>用户态的执行系统负责进程内部线程在非阻塞时的切换；内核态的操作系统负责阻塞线程的切换，即同时实现内核态和用户态线程管理。</code>当线程未阻塞时，由用户态对线程进行切换，当线程发生中断或异常时，切换到内核态执行中断处理。</p> <p>浏览器常见的进程有以下几种：
<img src="/record/assets/img/image-20230227173134193.84d92824.png" alt="image-20230227173134193"></p> <ul><li>Browser进程：浏览器的主进程，负责协调控制浏览器</li> <li>GPU进程：用于3D绘制等</li> <li>Network进程：负责发起接受网络请求</li> <li>Storage进程：从原来的主进程中分离出来的缓存服务，主要负责提供浏览器本地存储等功能</li> <li>渲染进程：负责控制显示tab标签页的内容</li> <li>插件进程：使用插件时创建的进程</li></ul> <p>其中渲染进程含有<code>5个主要线程</code></p> <ul><li>GUI渲染线程：负责渲染页面、解析Html和Css、构建DOM树、CSSOM树、Render树、绘制页面、重绘重排</li> <li>JS引擎线程：负责解析Javascript脚本，运行代码。<strong>与GUI渲染线程互斥</strong></li> <li>定时器线程：setInterval和setTimeout，因为JS引擎是单线程，如果处于阻塞状态会影响定时器的准确性，计时完毕后，添加到事件队列中，等待JS引擎空闲后执行</li> <li>异步http请求线程： 当XMLHttpRequest连接后，浏览器新开的一个线程，当检测到状态变化，将回调放入事件队列中，等待JS引擎执行。</li> <li>事件触发线程：主要用来控制事件循环(event-loop)，将对应任务添加到事件触发线程中，在对应事件符合触发条件触发时，就把事件添加到待处理队列的队尾，等JS引擎处理</li></ul> <h2 id="浏览器的网络请求"><a href="#浏览器的网络请求" class="header-anchor">#</a> 浏览器的网络请求</h2> <p>浏览器在输入网址到解析页面的过程中包含了一系列的网络请求</p> <p>（1）<strong>解析URL：</strong> 首先对 URL 进行解析，定位资源路径。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//统一资源定位符(URL)的语法规则</span>
<span class="token literal-property property">scheme</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>host<span class="token punctuation">.</span>domain<span class="token operator">:</span>port<span class="token operator">/</span>path<span class="token operator">/</span>filename
scheme <span class="token operator">-</span> 定义因特网服务的类型。常见的协议有 http、https、ftp、file
host <span class="token operator">-</span> <span class="token function">定义域主机</span><span class="token punctuation">(</span>http 的默认主机是 www<span class="token punctuation">)</span>
domain <span class="token operator">-</span> 定义因特网域名<span class="token punctuation">,</span>比如 w3school<span class="token punctuation">.</span>com<span class="token punctuation">.</span>cn
port <span class="token operator">-</span> <span class="token function">定义主机上的端口号</span><span class="token punctuation">(</span>http 的默认端口号是<span class="token number">80</span><span class="token punctuation">)</span>
path <span class="token operator">-</span> <span class="token function">定义服务器上的路径</span><span class="token punctuation">(</span>如果省略，则文档必须位于网站的根目录中<span class="token punctuation">)</span>
filename <span class="token operator">-</span> 定义文档<span class="token operator">/</span>资源的名称
</code></pre></div><p>如果URL不合法，会将地址栏中的内容传递给搜索引擎。此外，浏览器会对其中的非法字符进行转译，如admin等</p> <p>（2）<strong>缓存判断：</strong></p> <p>从缓存位置来看，缓存分为四种，从上到下依次查看是否命中</p> <p><strong>Service Worker</strong> 是运行在浏览器背后的独立线程，一般用来实现缓存功能。传输协议必须为HTTPS</p> <p><strong>Memory Cache</strong> 内存缓存，一旦关闭 Tab 页面，缓存会被释放</p> <p><strong>Disk Cache</strong> 硬盘缓存，读取速度慢，容量和存储时效性高，大部分缓存都来自Disk Cache，在HTTP的协议头中设置</p> <p><strong>Push Cache</strong> 推送缓存，HTTP/2 中的内容，当以上三种缓存都没有命中时，才被使用。只在会话（Session）中存在，一旦会话结束就被释放</p> <p>浏览器对于所请求资源的缓存处理主要包含以下三个策略：<strong>存储策略、过期策略、协商策略</strong>。其中，<strong>存储策略发生在收到请求响应后，用于决定是否缓存相应资源；过期策略发生在请求前，用于判断缓存是否过期；协商策略发生在请求中，用于判断缓存资源是否更新。</strong> 详见<a href="https://www.jianshu.com/p/5b8d61afe52d?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation" target="_blank" rel="noopener noreferrer">浏览器缓存策略<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/record/assets/img/image-20230228170246729.cf059093.png" alt="image-20230228170246729"></p> <p>在面对一个具体的http<a href="https://www.cnblogs.com/xikui/p/16203648.html#_label3_0_0_0" target="_blank" rel="noopener noreferrer">缓存需求<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>时，决策流程图如下:</p> <p><img src="/record/assets/img/image-20230228170754640.97596277.png" alt="image-20230228170754640"></p> <p>1.资源内容是否可以复用，Cache-Control设置为no-store</p> <p>2.是否每次都需要向服务器进行缓存有效确认，Cache-Control设置为no-cache</p> <p>3.资源是否可以被代理服务器缓存，设置为 private or public</p> <p>4.资源的过期时间，设置对应的 max-age值</p> <p>5.配置协商缓存需要用到的 Etag、Last-Modified 等参数</p> <p>（3）<strong>DNS解析：<strong>判断本地是否有该域名的 IP 地址的缓存，有则使用，如果没有则向本地 DNS 服务器发起请求。本地 DNS 服务器检查是否存在缓存，没有则向根域名服务器发起请求，依次</strong>递归</strong>向高级域名服务器查询，最终获得域名的 IP 地址后，本地 DNS 服务器将该 IP 地址返回给用户。</p> <p>（4）<strong>获取MAC地址：</strong> 获取到 IP 地址后，数据传输还需要目的主机 MAC 地址(用于数据链路层的通信)，获取MAC地址主要通过ARP协议(地址解析协议，ipv4网络层的必备协议，在ipv6中已经被替换为邻居发现协议NDP)，首先查看目标 IP 是否在自己的ARP表中，若不存在，则判断目标IP与自己是否在同一网段，若在同一网段，发送ARP广播报文，去请求解析出目标MAC地址，目标主机给出应答。否则，发送ARP广播报文，ARP包目标MAC地址是网关MAC地址，网关会给出应答。</p> <p>（5）<strong>TCP三次握手：</strong> 下面是 TCP 建立连接的三次握手的过程</p> <p><img src="/record/assets/img/image-20230302163716458.a34deb6b.png" alt="image-20230302163716458"></p> <ol><li><p>首先客户端向服务器发送一个 SYN 连接请求报文段和一个随机序号</p></li> <li><p>服务端接收到请求后向服务器端发送一个报文段，确认连接请求，并向客户端发送另一个随机序号。</p></li> <li><p>客户端接收服务器的确认应答后，进入连接建立的状态，同时向服务器也发送一个ACK 确认报文段，服务器端接收到确认后，也进入连接建立状态</p></li></ol> <p><strong>ps：a(喂，听得到吗)，b(听到了，你听得到我吗)，a(听到了，我们开始聊天吧)</strong></p> <p>（6）<strong>HTTPS握手：</strong> 如果使用 HTTPS 协议，在通信前还存在 <a href="https://blog.csdn.net/weixin_50764555/article/details/128611062?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167774628316800184137009%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=167774628316800184137009&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-3-128611062-null-null.142%5Ev73%5Einsert_down1,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&amp;utm_term=https%E6%8F%A1%E6%89%8B%E8%BF%87%E7%A8%8B&amp;spm=1018.2226.3001.4187" target="_blank" rel="noopener noreferrer">TLS 四次握手<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>过程。</p> <p><img src="/record/assets/img/tls_linked.98769f1b.png" alt="tls_linked"></p> <ol><li>客户端告诉给服务端，加密协议版本，加密套件(如RSA)，和一个**<code>客户端随机数</code>**</li> <li>服务端告诉客户端，一个**<code>服务器随机数</code>** + 服务器证书(CA) + 确定的加密协议版本</li> <li><ul><li>客户端生成<strong>新随机数</strong>，<strong><code>pre_master_key</code></strong> 。从服务器证书里取公钥，用公钥加密 <strong><code>pre_master_key</code></strong>，发给服务器。</li> <li>并使用个随机数进行计算得到一个<strong>会话秘钥</strong>。并通知服务端，后续用这个会话秘钥进行对称加密通信。</li> <li>客户端把迄今为止的通信数据内容生成一个摘要，用<strong>会话秘钥</strong>加密，发给服务器做校验</li></ul></li> <li><ul><li>服务端拿到客户端传来的**<code>pre_master_key</code><strong>，跟客户端一样，用这三个随机数同样获得一个</strong>会话秘钥**。并告诉客户端，后续用这个&quot;会话秘钥&quot;进行加密通信。</li> <li>服务端将迄今为止的通信数据内容生成一个摘要，用<strong>会话秘钥</strong>加密一下，发给客户端做校验</li></ul></li></ol> <p>（7）<strong>返回数据：</strong> 页面请求发送到服务器端后，服务器端返回相关文件作为响应，浏览器接收到响应后，对相关文件进行解析</p> <p>（8）<strong>页面渲染：</strong> 浏览器根据 html 文件构建 DOM 树，根据 css 文件构建 CSSOM 树，后根据 DOM 树和 CSSOM 树建立渲染树。后根据渲染树进行布局。布局完成后，使用 UI 接口对页面进行绘制。</p> <p>（9）<strong>TCP四次挥手：</strong> 下面是 TCP 断开连接的四次挥手过程。</p> <p><img src="/record/assets/img/image-20230302183703714.fc7f70a0.png" alt="image-20230302183703714"></p> <ol><li>客户端发出连接释放报文，并且停止发送数据。释放数据报文首部，FIN=1，seq=u</li> <li>服务器端接收到连接释放报文后，发出确认报文，ACK=1，ack=u+1，seq=v</li> <li>客户端收到确认请求后，<strong>客户端进入FIN-WAIT-2状态</strong>，等待服务器发送连接释放报文，服务器将数据发送完毕后，向客户端发送连接释放报文，<strong>服务器进入LAST-ACK状态</strong>，等待客户端的确认</li> <li>客户端收到连接释放报文后，发出确认报文，ACK=1，ack=w+1，seq=u+1，后进入TIME-WAIT状态，但此时TCP连接还未终止，经过2MSL后，客户端进入CLOSED状态，服务器端收到确认报文后，进入CLOSED关闭状态</li></ol> <p><strong>ps：a(那我先走了)，b(好的，你走吧)，b(我也走了)，a(好的，拜拜)</strong></p> <h2 id="浏览器的渲染过程"><a href="#浏览器的渲染过程" class="header-anchor">#</a> 浏览器的渲染过程</h2> <p><img src="/record/assets/img/image-20220809223355017.98690b71.png" alt="image-20220809223355017"></p> <blockquote><p>Html解析，解析DOM树</p></blockquote> <p>将原始字符转换成对应的节点对象，后将节点对象构建成树状结构</p> <blockquote><p>CSS解析，生成CSSOM树</p></blockquote> <blockquote><p>Render Tree</p></blockquote> <p>将DOM树和CSSOM树结合形成渲染树</p> <blockquote><p>layout</p></blockquote> <p>根据已知的节点和样式，计算节点在浏览器中的大小和位置</p> <p>从渲染树根节点开始遍历，用盒子模型表示各节点之间的距离，确定其位置和大小</p> <blockquote><p>Paint</p></blockquote> <p>将渲染树绘制</p> <ul><li><strong>load和DomContentload事件</strong></li></ul> <p>load：在所有资源加载完成后触发</p> <p>domcontentload：在html被<strong>解析完成</strong>(解析到html结束位置,async不计算在该时间内)后触发</p> <ul><li><strong>js和css对渲染的影响</strong></li></ul> <p>js会阻碍DOM树生成，阻碍图片，js，css等资源的加载</p> <p>js异步加载方式如下：</p> <p>defer：在文档加载完后执行，在domcontentload前</p> <p>async：文档加载与执行和js加载与执行是并行执行的</p> <p>css会阻塞CSSOM生成，阻碍页面渲染，阻碍js<strong>执行</strong></p> <h2 id="浏览器的同源策略"><a href="#浏览器的同源策略" class="header-anchor">#</a> 浏览器的同源策略</h2> <h2 id="浏览器的安全"><a href="#浏览器的安全" class="header-anchor">#</a> 浏览器的安全</h2> <h2 id="浏览器的存储"><a href="#浏览器的存储" class="header-anchor">#</a> 浏览器的存储</h2> <h2 id="浏览器的垃圾回收机制"><a href="#浏览器的垃圾回收机制" class="header-anchor">#</a> 浏览器的垃圾回收机制</h2> <h2 id="番外-抽象语法树的编译"><a href="#番外-抽象语法树的编译" class="header-anchor">#</a> 番外：抽象语法树的编译</h2></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/record/pages/frontend/vue.html" class="prev">
        Vue
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/record/assets/js/app.b06d3f04.js" defer></script><script src="/record/assets/js/2.f3c80cc9.js" defer></script><script src="/record/assets/js/4.df3bbc3b.js" defer></script>
  </body>
</html>
